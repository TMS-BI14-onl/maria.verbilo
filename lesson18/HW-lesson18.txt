--1
SELECT MANAGER_ID, COUNT(EMPLOYEE_ID) AS CNT
FROM EMPLOYEES
GROUP BY MANAGER_ID
HAVING COUNT (EMPLOYEE_ID)>6

--2
SELECT  D.DEPARTMENT_NAME, 
	MIN (E.SALARY*(1-(E.COMMISSION_PCT/100))) AS MIN,
	MAX (E.SALARY*(1-(E.COMMISSION_PCT/100))) AS MAX
FROM DEPARTMENTS D JOIN EMPLOYEES E ON D.DEPATMENT_ID=E.DEPATMENT_ID
GROUP BY D.DEPARTMENT_NAME

--3
SELECT TOP 1 WITH TIES R.REGION_NAME
FROM EMPLOYEES E JOIN DEPARTMENTS D ON E.DEPATMENT_ID=D.DEPATMENT_ID
		 JOIN LOCATION L ON D.LOCATION_ID=L.LOCATION_ID
		 JOIN COUNTRIES C ON L.COUNTRY_ID=C.COUNTRY_ID
		 JOIN REGIONS R ON C.REGION_ID=R.REGION_ID
GROUP BY REGION_NAME
ORDER BY COUNT (EMPLOYEEE_ID)

--4
SELECT 	D.DEPARTMENT_NAME,
	(AVG(E.SALARY) OVER (PARTITION BY DEPATMENT_ID)/AVG(E.SALARY) OVER ())*100 AS AVG_SEL
FROM DEPARTMENTS D JOIN EMPLOYEES E ON D.DEPATMENT_ID=E.DEPATMENT_ID

--6
SELECT  FIRST_NAME, 
	LAST_NAME, 
	SALARY
FROM
(
SELECT  FIRST_NAME, 
	LAST_NAME, 
	SALARY, 
	DENSE_RANK() OVER (ORDER BY SALARY DESC) as DR
FROM EMPLOYEES
) EMP
WHERE TOP BETWEEN 5 AND 10